{"ast":null,"code":"// Interface to the REST server\nconst baseURL = \"http://localhost:3001/\"; //const baseURL = \"http://www.debestrobotics.com/\";\n\nvar currSessionCookie;\nvar sessionId;\nconst headers = new Headers();\nheaders.set('Content-Type', 'application/JSON');\n\nfunction myFetch(method, endpoint, body) {\n  return fetch(baseURL + endpoint, {\n    method: method,\n    body: body ? JSON.stringify(body) : null,\n    headers: headers,\n    credentials: 'include'\n  }).catch(err => {\n    throw err;\n  });\n}\n\nexport function post(endpoint, body) {\n  return myFetch('POST', endpoint, body);\n} // GET/Usr/{email}\n\nexport function get(endpoint, body) {\n  return myFetch('GET', endpoint, body);\n} // GET/Usr \n//export function get(endpoint){\n//   return myFetch('GET', endpoint);\n//}\n\nexport function put(endpoint, body) {\n  return myFetch('PUT', endpoint, body);\n}\nexport function del(endpoint) {\n  return myFetch('DELETE', endpoint);\n} //  Functions for api requests\n\n/**\n * Register a user\n * @param {Object} User info\n * @returns {Promise resolving to new user registration}\n */\n\nexport function signUp(info) {\n  return post('Usr', info).catch(err => {\n    throw err;\n  });\n}\nexport function templogIn(creds) {\n  return post('Ssns', creds).catch(err => {\n    throw err;\n  });\n}\nexport function logOut() {\n  return del('Ssns/' + currSessionCookie).catch(err => {\n    throw err;\n  });\n}\nexport function logIn(cred) {\n  return post(\"Ssns\", cred).then(response => {\n    let location = response.headers.get(\"Location\").split('/');\n    sessionId = location[location.length - 1];\n    console.log(\"Got session \" + sessionId);\n    return get(\"Ssns/\" + sessionId);\n  }).then(response => response.json()) // ..json() returns a Promise!\n  .then(rsp => get('Prss/' + rsp.prsId)).then(userResponse => userResponse.json()).then(rsp => rsp[0]).catch(err => {\n    console.log('err was this', err);\n    throw err;\n  });\n}\n/**\n * @param User email to index database\n * @returns {Promise} json parsed data\n */\n\nexport function getUser(email) {\n  return get('Usr/' + email).then(res => res.json()).catch(err => {\n    throw err;\n  });\n}","map":{"version":3,"sources":["/Users/joshdebest/SeniorProject2020/ClientSide/src/api.js"],"names":["baseURL","currSessionCookie","sessionId","headers","Headers","set","myFetch","method","endpoint","body","fetch","JSON","stringify","credentials","catch","err","post","get","put","del","signUp","info","templogIn","creds","logOut","logIn","cred","then","response","location","split","length","console","log","json","rsp","prsId","userResponse","getUser","email","res"],"mappings":"AAAA;AAEA,MAAMA,OAAO,GAAG,wBAAhB,C,CACA;;AAEA,IAAIC,iBAAJ;AACA,IAAIC,SAAJ;AAEA,MAAMC,OAAO,GAAG,IAAIC,OAAJ,EAAhB;AACAD,OAAO,CAACE,GAAR,CAAY,cAAZ,EAA4B,kBAA5B;;AAEA,SAASC,OAAT,CAAiBC,MAAjB,EAAyBC,QAAzB,EAAmCC,IAAnC,EAAwC;AACrC,SAAOC,KAAK,CAACV,OAAO,GAAGQ,QAAX,EAAqB;AAC9BD,IAAAA,MAAM,EAAEA,MADsB;AAE9BE,IAAAA,IAAI,EAAGA,IAAI,GAAGE,IAAI,CAACC,SAAL,CAAeH,IAAf,CAAH,GAA0B,IAFP;AAG9BN,IAAAA,OAAO,EAAEA,OAHqB;AAI9BU,IAAAA,WAAW,EAAE;AAJiB,GAArB,CAAL,CAKJC,KALI,CAKEC,GAAG,IAAI;AAAC,UAAMA,GAAN;AAAU,GALpB,CAAP;AAMF;;AAED,OAAO,SAASC,IAAT,CAAcR,QAAd,EAAwBC,IAAxB,EAA6B;AACjC,SAAOH,OAAO,CAAC,MAAD,EAASE,QAAT,EAAmBC,IAAnB,CAAd;AACF,C,CACD;;AACA,OAAO,SAASQ,GAAT,CAAaT,QAAb,EAAuBC,IAAvB,EAA4B;AAChC,SAAOH,OAAO,CAAC,KAAD,EAAQE,QAAR,EAAkBC,IAAlB,CAAd;AACF,C,CACD;AACA;AACA;AACA;;AAEA,OAAO,SAASS,GAAT,CAAaV,QAAb,EAAuBC,IAAvB,EAA4B;AAChC,SAAOH,OAAO,CAAC,KAAD,EAAQE,QAAR,EAAkBC,IAAlB,CAAd;AACF;AACD,OAAO,SAASU,GAAT,CAAaX,QAAb,EAAsB;AAC1B,SAAOF,OAAO,CAAC,QAAD,EAAWE,QAAX,CAAd;AACF,C,CAED;;AAEA;;;;;;AAKA,OAAO,SAASY,MAAT,CAAgBC,IAAhB,EAAqB;AACzB,SAAOL,IAAI,CAAC,KAAD,EAAQK,IAAR,CAAJ,CAAkBP,KAAlB,CAAwBC,GAAG,IAAI;AAAC,UAAMA,GAAN;AAAU,GAA1C,CAAP;AACF;AAED,OAAO,SAASO,SAAT,CAAmBC,KAAnB,EAAyB;AAC7B,SAAOP,IAAI,CAAC,MAAD,EAASO,KAAT,CAAJ,CAAoBT,KAApB,CAA0BC,GAAG,IAAI;AAAC,UAAMA,GAAN;AAAU,GAA5C,CAAP;AACF;AAED,OAAO,SAASS,MAAT,GAAiB;AACrB,SAAOL,GAAG,CAAC,UAAUlB,iBAAX,CAAH,CAAiCa,KAAjC,CAAuCC,GAAG,IAAI;AAAC,UAAMA,GAAN;AAAU,GAAzD,CAAP;AACF;AAED,OAAO,SAASU,KAAT,CAAeC,IAAf,EAAqB;AACzB,SAAOV,IAAI,CAAC,MAAD,EAASU,IAAT,CAAJ,CACHC,IADG,CACEC,QAAQ,IAAI;AACf,QAAIC,QAAQ,GAAGD,QAAQ,CAACzB,OAAT,CAAiBc,GAAjB,CAAqB,UAArB,EAAiCa,KAAjC,CAAuC,GAAvC,CAAf;AACA5B,IAAAA,SAAS,GAAG2B,QAAQ,CAACA,QAAQ,CAACE,MAAT,GAAkB,CAAnB,CAApB;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,iBAAiB/B,SAA7B;AACA,WAAOe,GAAG,CAAC,UAAUf,SAAX,CAAV;AACF,GANG,EAOHyB,IAPG,CAOEC,QAAQ,IAAIA,QAAQ,CAACM,IAAT,EAPd,EAOiC;AAPjC,GAQHP,IARG,CAQEQ,GAAG,IAAIlB,GAAG,CAAC,UAAUkB,GAAG,CAACC,KAAf,CARZ,EASHT,IATG,CASEU,YAAY,IAAIA,YAAY,CAACH,IAAb,EATlB,EAUHP,IAVG,CAUEQ,GAAG,IAAIA,GAAG,CAAC,CAAD,CAVZ,EAWHrB,KAXG,CAWGC,GAAG,IAAI;AAACiB,IAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA2BlB,GAA3B;AAAgC,UAAMA,GAAN;AAAU,GAXrD,CAAP;AAYF;AAED;;;;;AAIA,OAAO,SAASuB,OAAT,CAAiBC,KAAjB,EAAwB;AAC5B,SAAOtB,GAAG,CAAE,SAASsB,KAAX,CAAH,CACNZ,IADM,CACDa,GAAG,IAAIA,GAAG,CAACN,IAAJ,EADN,EAENpB,KAFM,CAEAC,GAAG,IAAI;AAAC,UAAMA,GAAN;AAAU,GAFlB,CAAP;AAGF","sourcesContent":["// Interface to the REST server\n\nconst baseURL = \"http://localhost:3001/\";\n//const baseURL = \"http://www.debestrobotics.com/\";\n\nvar currSessionCookie;\nvar sessionId;\n\nconst headers = new Headers();\nheaders.set('Content-Type', 'application/JSON');\n\nfunction myFetch(method, endpoint, body){\n   return fetch(baseURL + endpoint, {\n      method: method,\n      body: (body ? JSON.stringify(body) : null),\n      headers: headers,\n      credentials: 'include'\n   }).catch(err => {throw err});\n}\n\nexport function post(endpoint, body){\n   return myFetch('POST', endpoint, body);\n}\n// GET/Usr/{email}\nexport function get(endpoint, body){\n   return myFetch('GET', endpoint, body);\n}\n// GET/Usr \n//export function get(endpoint){\n//   return myFetch('GET', endpoint);\n//}\n\nexport function put(endpoint, body){\n   return myFetch('PUT', endpoint, body);\n}\nexport function del(endpoint){\n   return myFetch('DELETE', endpoint);\n}\n\n//  Functions for api requests\n\n/**\n * Register a user\n * @param {Object} User info\n * @returns {Promise resolving to new user registration}\n */\nexport function signUp(info){\n   return post('Usr', info).catch(err => {throw err});\n}\n\nexport function templogIn(creds){\n   return post('Ssns', creds).catch(err => {throw err});\n}\n\nexport function logOut(){\n   return del('Ssns/' + currSessionCookie).catch(err => {throw err});\n}\n\nexport function logIn(cred) {\n   return post(\"Ssns\", cred)\n      .then(response => {\n         let location = response.headers.get(\"Location\").split('/');\n         sessionId = location[location.length - 1];\n         console.log(\"Got session \" + sessionId);\n         return get(\"Ssns/\" + sessionId)\n      })\n      .then(response => response.json())   // ..json() returns a Promise!\n      .then(rsp => get('Prss/' + rsp.prsId))\n      .then(userResponse => userResponse.json())\n      .then(rsp => rsp[0])\n      .catch(err => {console.log('err was this',err);throw err}) \n}\n\n/**\n * @param User email to index database\n * @returns {Promise} json parsed data\n */\nexport function getUser(email) {\n   return get ('Usr/' + email)\n   .then(res => res.json())\n   .catch(err => {throw err});\n}\n"]},"metadata":{},"sourceType":"module"}